--RATIO DE NUMERO DE CAMAS POR POBLACION
SELECT H.COMUNIDAD_AUTONOMA, SUM(H.NUMERO_DE_CAMAS), P.POBLACION
FROM HOSPITALES H
JOIN POBLACION P ON H.COMUNIDAD_AUTONOMA = P.COMUNIDAD_AUTONOMA
GROUP BY H.COMUNIDAD_AUTONOMA;

--RATIO DE GASTO EN SANIDAD POR HABITANTE
SELECT G.COMUNIDAD_AUTONOMA, G.GASTO_SANIDAD, P.POBLACION
FROM GASTO_SANIDAD G
JOIN POBLACION P ON G.COMUNIDAD_AUTONOMA = P.COMUNIDAD_AUTONOMA
GROUP BY G.COMUNIDAD_AUTONOMA;

--RELACION EN EL NUMERO DE CAMAS Y LA INVERSION POR CCAA
SELECT H.COMUNIDAD_AUTONOMA, SUM(H.NUMERO_DE_CAMAS), G.GASTO_SANIDAD, P.POBLACION, 
       ROUND(CAST(SUM(H.NUMERO_DE_CAMAS) AS FLOAT)/CAST(P.POBLACION AS FLOAT), 5) AS CAMA_HABITANTE
FROM HOSPITALES H
JOIN GASTO_SANIDAD G ON H.COMUNIDAD_AUTONOMA = G.COMUNIDAD_AUTONOMA
JOIN POBLACION P ON H.COMUNIDAD_AUTONOMA = P.COMUNIDAD_AUTONOMA
GROUP BY H.COMUNIDAD_AUTONOMA;

--RELACION INVERSION Y NUMERO DE MAQUINAS
SELECT E.*, G.GASTO_SANIDAD, P.POBLACION
FROM EQUIPO_MEDICO E
JOIN GASTO_SANIDAD G ON E.COMUNIDAD_AUTONOMA = G.COMUNIDAD_AUTONOMA
JOIN POBLACION P ON E.COMUNIDAD_AUTONOMA = P.COMUNIDAD_AUTONOMA
GROUP BY E.COMUNIDAD_AUTONOMA;

--RELACION ENTRE PIB PER CAPITA Y GASTO EN SANIDAD PER CAPITA
SELECT PI.*, G.GASTO_SANIDAD, P.POBLACION, ROUND(CAST(PI.PIB AS FLOAT)/CAST(P.POBLACION AS FLOAT), 5) AS PIB_PER_CAPITA,
        ROUND(CAST(G.GASTO_SANIDAD AS FLOAT)/CAST(P.POBLACION AS FLOAT), 5) AS GASTO_HABITANTE
FROM PIB PI
JOIN POBLACION P ON PI.COMUNIDAD_AUTONOMA = P.COMUNIDAD_AUTONOMA
JOIN GASTO_SANIDAD G ON P.COMUNIDAD_AUTONOMA = G.COMUNIDAD_AUTONOMA
GROUP BY PI.COMUNIDAD_AUTONOMA;